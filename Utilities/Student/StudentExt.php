<?php/** * Created by PhpStorm. * User: leon-pc * Date: 11/16/2016 * Time: 10:12 AM */function getAllStudentsIds1($student_name){    require (REQUIRE_CONNECTION);    $query = "             SELECT                  *            FROM students                        WHERE name LIKE '". $student_name ."%'        ";    try {        $stmt   = $db->prepare($query);        $result = $stmt->execute();    }    catch (PDOException $ex) {        echo $ex;        return null;    }    $ids = array();    while ($data = $stmt->fetch())    {        $ids[] = $data['ID'];    }    return $ids;}function getAllStudentsIds($course_id){    require (REQUIRE_CONNECTION);    $query = "             SELECT                  *            FROM students                        WHERE course_id = '$course_id'        ";    try {        $stmt   = $db->prepare($query);        $result = $stmt->execute();    }    catch (PDOException $ex) {        echo $ex;        return null;    }    $ids = array();    while ($data = $stmt->fetch())    {        $ids[] = $data['ID'];    }    return $ids;}function registerStudent($name,$surname,$stu_num,$id_num,$phone_number,$address,$course_id,$parent){    require (REQUIRE_CONNECTION);    require (REQUIRE_DATE);         $query2 = "             SELECT                  fees            FROM course             WHERE ID = '" . $course_id . "'        ";                try {            //$stmt   = $db->prepare($query);            $stmt2 = $db->prepare($query2);            //$result = $stmt->execute();            $result2 = $stmt2->execute();        }        catch (PDOException $ex) {            die ($ex);            return false;        }                        $data2 = $stmt2->fetch();    $query = "INSERT INTO students 	( name,surname,student_id,id_number,phone_number,address,course_id,date_created,balance,fees,parent_guardian) VALUES  	( :name , :surname, :student_id, :id_number, :phone_number,:address,:course_id,:date_created,:balance, :fees, :parent_guardian)";    $query_params = array(        ':name' => $name,                ':surname' => $surname,                ':student_id' => $stu_num,                ':id_number' => $id_num,        ':phone_number' => $phone_number,        ':address' => $address,        ':course_id' => $course_id,        ':date_created' => getCurrentDateString(),                ':balance' => $data2['fees'],                ':fees' => $data2['fees'],                ':parent_guardian' => $parent    );    try {        $stmt = $db->prepare($query);        $result = $stmt->execute($query_params);        return true;    }    catch (PDOException $ex) {        echo $ex;        return false;    }}function deleteStudent($id){    require (REQUIRE_CONNECTION);    $query = "DELETE FROM students WHERE ID =  '". $id."'";    try {        $stmt = $db->prepare($query);        $result = $stmt->execute();        return true;    }    catch (PDOException $ex) {        echo $ex;        return false;    }}function getStudentsIdsUsingCourseId($course_id){    require (REQUIRE_CONNECTION);    $query = "             SELECT                  *            FROM students WHERE course_id = '$course_id'        ";    try {        $stmt   = $db->prepare($query);        $result = $stmt->execute();    }    catch (PDOException $ex) {        echo $ex;        return null;    }    $ids = array();    while ($data = $stmt->fetch())    {        $ids[] = $data['ID'];    }    return $ids;}function updateStudentInfo($id,$array_keys,$array_data){    require (REQUIRE_CONNECTION);    $pos = 0;    foreach ($array_keys as $array_key) {        if($array_data[$pos] == -1 || $array_data[$pos] == null)            continue;        $query = "UPDATE students SET $array_key = '" . $array_data[$pos] . "' WHERE ID = '" . $id . "'";        try {            $stmt = $db->prepare($query);            $result = $stmt->execute();                        //return true;        } catch (PDOException $ex) {            echo $ex;        }        $pos++;    }    return true;}